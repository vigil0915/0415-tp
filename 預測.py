# -*- coding: utf-8 -*-
"""èª²æœ¬P2-47ç¶œåˆç¯„ä¾‹-ç¬¬ä¸€é¡Œ-æ³¢å£«é “æˆ¿åƒ¹é æ¸¬_ä¿®æ­£è³‡æ–™ä¾†æº.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1YpnGemeYBk5hafUayGOzrCdFuneJt33v
"""

# 1. è¼‰å…¥è³‡æ–™èˆ‡å¥—ä»¶
import pandas as pd
import numpy as np
from sklearn.linear_model import LinearRegression
from sklearn.model_selection import train_test_split
from sklearn.metrics import mean_absolute_error, mean_squared_error

# å¾å…¬é–‹ç¶²å€è®€å–è³‡æ–™
url = "https://raw.githubusercontent.com/selva86/datasets/master/BostonHousing.csv"
df = pd.read_csv(url)
df.head()

# Xï¼šç”¨ä¾†é æ¸¬çš„ç‰¹å¾µï¼ˆä¸åŒ…å« medvï¼‰
X = df.drop("medv", axis=1)
# yï¼šæˆ¿åƒ¹
y = df["medv"]

X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=1)

model = LinearRegression() #æ­¤è¡Œåœ¨ å»ºç«‹ä¸€å€‹ã€Œç·šæ€§å›æ­¸æ¨¡å‹ã€çš„ç©ºæ®¼å­ï¼Œå°±åƒä½ å…ˆè²·äº†ä¸€å°æ²’è¨“ç·´éçš„ AIã€‚

model.fit(X_train, y_train) #æ­¤è¡Œåœ¨ è¨“ç·´æ¨¡å‹ï¼šè®“ model å­¸æœƒã€Œæ€éº¼å¾æˆ¿å­çš„ç‰¹å¾µï¼ˆXï¼‰é æ¸¬æˆ¿åƒ¹ï¼ˆyï¼‰ã€ã€‚

"""ç”¨ç™½è©±èªªï¼š
ğŸ‘‰ã€Œæ‹¿é€™äº›è¨“ç·´è³‡æ–™ï¼ˆX èˆ‡ yï¼‰å»æ•™æœƒé€™å€‹æ¨¡å‹ï¼Œè®“å®ƒå­¸æœƒæˆ¿åƒ¹çš„è¨ˆç®—é‚è¼¯ã€
å­¸ç¿’ä¹‹å¾Œï¼Œé€™å°æ¨¡å‹å°±å¯ä»¥å¹«ä½ é æ¸¬ã€Œæ–°çš„æˆ¿å­ã€å¤§ç´„å€¼å¤šå°‘éŒ¢å•¦!
"""

# é æ¸¬æ¸¬è©¦è³‡æ–™
y_pred = model.predict(X_test)

mae = mean_absolute_error(y_test, y_pred)
mse = mean_squared_error(y_test, y_pred)
rmse = np.sqrt(mse)

print(f"å¹³å‡çµ•å°èª¤å·® MAE: {mae:.4f}")
print(f"å‡æ–¹èª¤å·® MSE: {mse:.4f}")
print(f"å‡æ–¹æ ¹èª¤å·® RMSE: {rmse:.4f}")

# ä½¿ç”¨æŒ‡å®šè¼¸å…¥è³‡æ–™
X_new = [[0.00632, 18.00, 2.310, 0, 0.5380, 6.5750, 65.20,
          4.0900, 1, 296.0, 15.30, 396.90 , 4.98]]

predicted_price = model.predict(X_new)[0]
print(f"é€™é–“æˆ¿å­çš„é æ¸¬åƒ¹æ ¼ï¼šç´„ {round(predicted_price, 4)} åƒç¾å…ƒ")